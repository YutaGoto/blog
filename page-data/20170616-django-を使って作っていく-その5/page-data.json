{"componentChunkName":"component---src-templates-blog-post-js","path":"/20170616-django-を使って作っていく-その5/","result":{"data":{"site":{"siteMetadata":{"title":".ごっちの日記","siteUrl":"https://yutagoto.github.io"}},"markdownRemark":{"id":"caa42566-c562-58d1-b9eb-218d15c28f30","excerpt":"どうもこんにちは、ごっちです。 先日、Bower とかとかの導入は次あたりにでもやろうかしら。いちいち Zip を落としてきてやるのはいかんせんよくない気がする。とか書いたので、それをやる。 今回の成果 せっかくだから jQuery…","html":"<p>どうもこんにちは、ごっちです。</p>\n<p>先日、<a href=\"https://medium.com/@gggooottto/django-%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E4%BD%9C%E3%81%A3%E3%81%A6%E3%81%84%E3%81%8F-%E3%81%9D%E3%81%AE4-3a75e2d8d642\">Bower とかとかの導入は次あたりにでもやろうかしら。いちいち Zip を落としてきてやるのはいかんせんよくない気がする。</a>とか書いたので、それをやる。</p>\n<h2>今回の成果</h2>\n<p>せっかくだから jQuery とかもいれたいよね。業界的にはトレンドじゃない感じがあるけれども。</p>\n<p>調べると<a href=\"https://github.com/nvbn/django-bower\">django-bower</a>というものがあるじゃないですか！これを使っていきましょう</p>\n<h2>Dockerfile をいじる</h2>\n<p>bower, nodejs は Python コードをどうこうする感じじゃないので DockerImage を作っていくときに必要ですねー</p>\n<p>bower</p>\n<p>何も考えなしで、 Dockerfile に RUN pip install django-bower とか書いたら動くかなぁとか思って実行したら、、、通ったには通ったけども、、</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker-compose run --rm web python manage.py bower install\nBowerNotInstalled: Bower not installed, read instruction here - http://bower.io/</code></pre></div>\n<p>できてねぇし。</p>\n<p>そういえば、そもそもこの Dockerfile で bower をインストールするようなコマンドなかったから RUN npm install -g bower を書いたら動くんじゃね？</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Step 5/9 : RUN npm install -g bower\n ---&gt; Running in 373df8845c53\n/bin/sh: 1: npm: not found\nERROR: Service &#39;web&#39; failed to build: The command &#39;/bin/sh -c npm install -g bower&#39; returned a non-zero code: 127</code></pre></div>\n<p>npm からか。</p>\n<p>じゃあ、npm をインストールするために RUN apt-get install npm も書いてやるよ</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Step 4/11 : RUN apt-get install npm\n ---&gt; Running in eca5880bfdbf\nReading package lists...\nBuilding dependency tree...\nReading state information...\nThe following extra packages will be installed:\n  ...........\n0 upgraded, 68 newly installed, 0 to remove and 1 not upgraded.\nNeed to get 6462 kB of archives.\nAfter this operation, 20.0 MB of additional disk space will be used.\nDo you want to continue? [Y/n] Abort.\nERROR: Service &#39;web&#39; failed to build: The command &#39;/bin/sh -c apt-get install npm&#39; returned a non-zero code: 1</code></pre></div>\n<p>回答できずに終了はさすがにこまる。</p>\n<p>とりあえず、オプションをつけるか。 RUN apt-get install -y nodejs npm で実行。ついでに nodejs も入れる。</p>\n<p>っで無事に通過するという。よかったよかった。</p>\n<p>settings.py にいろいろ設定を書いていこうじゃないか。<a href=\"https://github.com/nvbn/django-bower\">django-bower</a>を参考に書いていく</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">import os\n\n# Build paths inside the project like this: os.path.join(BASE_DIR, ...)\nBASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))\n\n\n# Application definition\n\nINSTALLED_APPS = [\n    &#39;blogs.apps.BlogsConfig&#39;,\n    &#39;django.contrib.admin&#39;,\n    &#39;django.contrib.auth&#39;,\n    &#39;django.contrib.contenttypes&#39;,\n    &#39;django.contrib.sessions&#39;,\n    &#39;django.contrib.messages&#39;,\n    &#39;django.contrib.staticfiles&#39;,\n    &#39;djangobower&#39;,\n]\n\n\n# Static files (CSS, JavaScript, Images)\n# https://docs.djangoproject.com/en/1.11/howto/static-files/\n\nSTATIC_ROOT = os.path.join(BASE_DIR, &#39;static&#39;)\n\nSTATIC_URL = &#39;/static/&#39;\n\nBOWER_COMPONENTS_ROOT = os.path.join(BASE_DIR, &#39;components&#39;)\n\nSTATICFILES_FINDERS = (\n    # &#39;django.contrib.staticfiles.finders.FileSystemFinder&#39;,\n    # &#39;django.contrib.staticfiles.finders.AppDirectoriesFinder&#39;,\n    &#39;djangobower.finders.BowerFinder&#39;,\n)\n\nBOWER_INSTALLED_APPS = (\n    &#39;jquery&#39;,\n    &#39;Rin&#39;,\n)</code></pre></div>\n<p>もろもろ DB 情報も書いてあるけど割愛して、こんな感じ。</p>\n<p>よし、jQuery とか入れていくぞ！</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker-compose run --rm web python manage.py bower install\n/usr/bin/env: node: No such file or directory</code></pre></div>\n<p>ねぇのかよ！</p>\n<p>なんか調べていったらこんな<a href=\"https://github.com/nvbn/django-bower/issues/51\">issue</a>が見つかるという。</p>\n<blockquote>\n<p><em>Error when arguments are passed to manage.py bower install</em></p>\n</blockquote>\n<p>で最後の回答がこれ。</p>\n<blockquote>\n<p><em>python manage.py bower</em>install —allow-root worked for me_</p>\n</blockquote>\n<p>引数変わったのね。というわけで実行。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker-compose run --rm web python manage.py bower_install --allow-root\nbower jquery#*              not-cached https://github.com/jquery/jquery-dist.git#*\nbower jquery#*                 resolve https://github.com/jquery/jquery-dist.git#*\nbower Rin#*                 not-cached https://github.com/raryosu/Rin.git#*\nbower Rin#*                    resolve https://github.com/raryosu/Rin.git#*\nbower Rin#*                   download https://github.com/raryosu/Rin/archive/v3.3.7.tar.gz\nbower jquery#*                download https://github.com/jquery/jquery-dist/archive/3.2.1.tar.gz\nbower Rin#*                    extract archive.tar.gz\nbower jquery#*                 extract archive.tar.gz\nbower Rin#*               invalid-meta for:/tmp/2727f3e897b68080dc4d7e018b3a3224/bower/236fe879dd62a6a3981a6ff632138c1b-6-70Yt9E/bower.json\nbower Rin#*               invalid-meta The &quot;name&quot; is recommended to be lowercase, can contain digits, dots, dashes\nbower Rin#*               invalid-meta The &quot;main&quot; field cannot contain minified files\nbower Rin#*                   resolved https://github.com/raryosu/Rin.git#3.3.7\nbower jquery#*                resolved https://github.com/jquery/jquery-dist.git#3.2.1\nbower Honoka#^3.3.7            install Honoka#3.3.7\nbower jquery#^3.2.1            install jquery#3.2.1\n\nHonoka#3.3.7 bower_components/Honoka\n\njquery#3.2.1 bower_components/jquery</code></pre></div>\n<p>よしよし、なかなか順調じゃないですか。</p>\n<p>実際に起動してみる</p>\n<p>CSS 反映されてねぇ。。。</p>\n<p>日本語のドキュメントがなかなかないので、その辺も結構しんどいね。</p>\n<h2>結局</h2>\n<p>ちょっとうまくいかない感じがあるので、そのうちまた手を出そう。そうしよう。</p>\n<h2>References</h2>\n<ul>\n<li>Django を使って作っていく その 4, <a href=\"https://medium.com/@gggooottto/django-%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E4%BD%9C%E3%81%A3%E3%81%A6%E3%81%84%E3%81%8F-%E3%81%9D%E3%81%AE4-3a75e2d8d642\">https://medium.com/@gggooottto/django-%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E4%BD%9C%E3%81%A3%E3%81%A6%E3%81%84%E3%81%8F-%E3%81%9D%E3%81%AE4-3a75e2d8d642</a></li>\n<li>nvbn/django-bower, <a href=\"https://github.com/nvbn/django-bower\">https://github.com/nvbn/django-bower</a></li>\n<li>raryosu/Rin, <a href=\"https://github.com/raryosu/Rin\">https://github.com/raryosu/Rin</a></li>\n<li>hudsonbrendon/docker-django-bower-grunt, <a href=\"https://hub.docker.com/r/hudsonbrendon/docker-django-bower-grunt/%7E/dockerfile/\">https://hub.docker.com/r/hudsonbrendon/docker-django-bower-grunt/~/dockerfile/</a></li>\n<li>【 apt-get 】 パッケージを取得してインストール/アップデートする, <a href=\"http://itpro.nikkeibp.co.jp/article/COLUMN/20060227/230709/?rt=nocnt\">http://itpro.nikkeibp.co.jp/article/COLUMN/20060227/230709/?rt=nocnt</a></li>\n<li>jquery, <a href=\"https://www.npmjs.com/package/jquery\">https://www.npmjs.com/package/jquery</a></li>\n<li>Error when arguments are passed to manage.py bower install #51, <a href=\"https://github.com/nvbn/django-bower/issues/51\">https://github.com/nvbn/django-bower/issues/51</a></li>\n<li>YutaGoto/blog<em>system</em>on<em>django, [<a href=\"https://github.com/YutaGoto/blog\">https://github.com/YutaGoto/blog</a></em>system<em>on</em>django](<a href=\"https://github.com/YutaGoto/blog_system_on_django\">https://github.com/YutaGoto/blog_system_on_django</a>)</li>\n</ul>\n<p><em>Originally published at <a href=\"https://gist.github.com/YutaGoto/04cd8cb3d794cdec248c49cdf1548ff8\">gist.github.com</a>.</em></p>","fields":{"slug":"/20170616-django-を使って作っていく-その5/"},"frontmatter":{"title":"Django を使って作っていく その5","date":"June 16, 2017","description":"Django を使って作っていく その5"}},"previous":{"fields":{"slug":"/20170612-django-を使って作っていく-その4/"},"frontmatter":{"title":"Django を使って作っていく その4"}},"next":{"fields":{"slug":"/20170905-25-years-old/"},"frontmatter":{"title":"25 years old"}}},"pageContext":{"id":"caa42566-c562-58d1-b9eb-218d15c28f30","previousPostId":"bd80a0f6-e428-549a-a58f-0813009d4bcc","nextPostId":"c176b7f4-0ca4-599f-90e5-6ef5e6cb7215"}},"staticQueryHashes":["2137539840","2201837728"]}