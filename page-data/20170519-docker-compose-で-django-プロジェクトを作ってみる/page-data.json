{"componentChunkName":"component---src-templates-blog-post-js","path":"/20170519-docker-compose-で-django-プロジェクトを作ってみる/","result":{"data":{"site":{"siteMetadata":{"title":".ごっちの日記","siteUrl":"https://yutagoto.github.io"}},"markdownRemark":{"id":"39bbe626-c561-5926-b685-10dd422a6572","excerpt":"どうもこんにちは。ごっちです。 Docker Compose のチュートリアルをわさーとやっているところですが、ひとまずこれで最後。Django プロジェクトを作ってみます。 公式のチュートリアルに則って進めます。 ファイルの準備 Dockerfile requirements.txt docker-compose…","html":"<p>どうもこんにちは。ごっちです。</p>\n<p>Docker Compose のチュートリアルをわさーとやっているところですが、ひとまずこれで最後。Django プロジェクトを作ってみます。</p>\n<p>公式の<a href=\"https://docs.docker.com/compose/django/\">チュートリアル</a>に則って進めます。</p>\n<h2>ファイルの準備</h2>\n<ul>\n<li>Dockerfile</li>\n<li>requirements.txt</li>\n<li>docker-compose.yml</li>\n</ul>\n<h2>Dockerfile</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">FROM python:3\nENV PYTHONUNBUFFERED 1\nRUN mkdir /code\nWORKDIR /code\nADD requirements.txt /code/\nRUN pip install -r requirements.txt\nADD . /code/</code></pre></div>\n<h2>requirements.txt</h2>\n<p>Dockerfile に RUN pip install -r requirements.txt とあるので、ここに Django のバージョンなど、必要な情報を書きます。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Django&gt;=1.8,&lt;2.0\npsycopg2</code></pre></div>\n<h2>docker-compose.yml</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">version: &#39;2&#39;\nservices:\n  db:\n    image: postgres\n  web:\n    build: .\n    command: python3 manage.py runserver 0.0.0.0:8000\n    volumes:\n      - .:/code\n    ports:\n      - &quot;8000:8000&quot;\n    depends_on:\n      - db</code></pre></div>\n<h2>プロジェクトの新規作成</h2>\n<p>一通り下準備ができたので、プロジェクトを作ります。今回のプロジェクト名は django_docker とします。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker-compose run web django-admin.py startproject django_docker .\nCreating network &quot;djangodocker_default&quot; with the default driver\nPulling db (postgres:latest)...\nlatest: Pulling from library/postgres\n10a267c67f42: Pull complete\n...</code></pre></div>\n<p>それぞれのコマンドが何をしているかは割愛します。。</p>\n<p>もろもろ終わったら、プロジェクトディレクトリがあるか確認します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ ls\nDockerfile django_docker docker-compose.yml manage.py requirements.txt</code></pre></div>\n<h2>DB の設定</h2>\n<p>Django のデフォルトでは SQlite が入るのですが、今回は PostgreSQL をしようします。</p>\n<p>django_docker/settings.py の DATABASES の部分を以下のように編集します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">DATABASES = {\n    &#39;default&#39;: {\n         &#39;ENGINE&#39;: &#39;django.db.backends.postgresql&#39;,\n         &#39;NAME&#39;: &#39;postgres&#39;,\n         &#39;USER&#39;: &#39;postgres&#39;,\n         &#39;HOST&#39;: &#39;db&#39;,\n         &#39;PORT&#39;: 5432,\n    }\n}</code></pre></div>\n<h2>Django の起動</h2>\n<p>もろもろ設定が終わったところで Django を起動します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ docker-compose up\ndjangodocker_db_1 is up-to-date\nCreating djangodocker_web_1\nAttaching to djangodocker_db_1, djangodocker_web_1\ndb_1   | The files belonging to this database system will be owned by user &quot;postgres&quot;.\ndb_1   | This user must also own the server process.\n...\nweb_1  | Performing system checks...\nweb_1  |\nweb_1  | System check identified no issues (0 silenced).\nweb_1  |\nweb_1  | You have 13 unapplied migration(s). Your project may not work properly until you apply the migrations for app(s): admin, auth, contenttypes, sessions.\nweb_1  | Run &#39;python manage.py migrate&#39; to apply them.\nweb_1  | May 19, 2017 - 08:09:36\nweb_1  | Django version 1.11.1, using settings &#39;composeexample.settings&#39;\nweb_1  | Starting development server at http://0.0.0.0:8000/\nweb_1  | Quit the server with CONTROL-C.</code></pre></div>\n<p>となれば起動成功です。 <a href=\"http://localhost:8000\">http://localhost:8000</a> にアクセスしましょう。</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/3600/0*wsF19HFB1b4v3ZsA.PNG\"></p>\n<p>と表示されるはずです。</p>\n<p>止める場合は Ctrl + C で止めます。</p>\n<h2>今後</h2>\n<p>Django の勉強でもしようかしら。。。</p>\n<h2>References</h2>\n<ul>\n<li>Quickstart: Compose and Django, <a href=\"https://docs.docker.com/compose/django/\">https://docs.docker.com/compose/django/</a></li>\n<li>はじめての Django アプリ作成、その 1, <a href=\"https://docs.djangoproject.com/ja/1.11/intro/tutorial01/\">https://docs.djangoproject.com/ja/1.11/intro/tutorial01/</a></li>\n<li>YutaGoto/django<em>docker, [<a href=\"https://github.com/YutaGoto/django\">https://github.com/YutaGoto/django</a></em>docker](<a href=\"https://github.com/YutaGoto/django_docker\">https://github.com/YutaGoto/django_docker</a>)</li>\n</ul>\n<p><em>Originally published at <a href=\"https://gist.github.com/YutaGoto/b14b8e165ef5c698f39d5324ed270425\">gist.github.com</a>.</em></p>","fields":{"slug":"/20170519-docker-compose-で-django-プロジェクトを作ってみる/"},"frontmatter":{"title":"Docker Compose で Django プロジェクトを作ってみる","date":"May 19, 2017","description":"Docker Compose で Django プロジェクトを作ってみる"}},"previous":{"fields":{"slug":"/20170516-docker-composeでphp7を動かしてみる/"},"frontmatter":{"title":"Docker ComposeでPHP7を動かしてみる"}},"next":{"fields":{"slug":"/20170521-docker-compose-で-python-を動かすの巻/"},"frontmatter":{"title":"Docker Compose で Python を動かすの巻"}}},"pageContext":{"id":"39bbe626-c561-5926-b685-10dd422a6572","previousPostId":"4ed8f1dd-d5d2-5d3f-bc4e-9a83f67385a2","nextPostId":"9deeb478-bcbe-53cf-bff9-0e2a2f25c8bd"}},"staticQueryHashes":["2137539840","2201837728"]}